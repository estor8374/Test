<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF generator ¬∑ direct download | proper UI</title>
  <!-- fonts & basic styling -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz@0,14..32;1,14..32&family=Merriweather&family=Source+Code+Pro&display=swap" rel="stylesheet">
  <!-- html2canvas & jspdf from CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #f0f4f9;
      font-family: 'Inter', sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 1.5rem;
    }

    .tool-container {
      max-width: 1400px;
      width: 100%;
      background: white;
      border-radius: 2.5rem;
      box-shadow: 0 30px 60px rgba(0, 10, 30, 0.2);
      padding: 2rem;
    }

    h1 {
      font-size: clamp(2rem, 6vw, 3rem);
      font-weight: 600;
      letter-spacing: -0.02em;
      color: #0b1f33;
      margin-bottom: 0.25rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .subhead {
      color: #4f658d;
      margin-bottom: 2rem;
      font-size: 1rem;
      border-left: 5px solid #3b82f6;
      padding-left: 1.2rem;
    }

    .dashboard {
      display: flex;
      flex-wrap: wrap;
      gap: 2rem;
    }

    .control-panel {
      flex: 1 1 360px;
      background: #f9fcff;
      border-radius: 2rem;
      padding: 2rem 1.8rem;
      box-shadow: inset 0 1px 5px rgba(0,0,0,0.02), 0 8px 18px rgba(0,20,50,0.05);
    }

    .preview-area {
      flex: 2 1 500px;
      display: flex;
      flex-direction: column;
    }

    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      margin-bottom: 1.2rem;
    }

    .preview-header h2 {
      font-weight: 500;
      color: #1e2b3c;
    }

    .generate-btn {
      background: #0b1f33;
      border: none;
      color: white;
      padding: 0.8rem 2.5rem;
      border-radius: 40px;
      font-size: 1.1rem;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      box-shadow: 0 10px 18px -8px #0b1f33b0;
      transition: 0.15s;
      border: 1px solid #ffffff30;
    }

    .generate-btn:hover {
      background: #1e3f62;
      transform: scale(1.02);
    }

    .generate-btn:active {
      transform: scale(0.98);
    }

    .card-preview {
      background: #ffffff;
      border-radius: 2rem;
      box-shadow: 0 20px 35px -5px rgba(0,0,0,0.15);
      padding: 2rem;
      border: 1px solid #eef2f6;
      transition: all 0.2s;
      min-height: 300px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    #previewCard h2 {
      font-size: 2.5rem;
      font-weight: 700;
      line-height: 1.2;
      margin-bottom: 0.5rem;
    }

    #previewCard h3 {
      font-size: 1.5rem;
      font-weight: 400;
      margin-bottom: 1.2rem;
      opacity: 0.8;
    }

    #previewCard p {
      font-size: 1.2rem;
      line-height: 1.5;
    }

    /* form elements */
    .control-group {
      margin-bottom: 2rem;
    }

    .label-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
      color: #2c3f5c;
      font-weight: 500;
    }

    .label-row span:first-child {
      text-transform: uppercase;
      font-size: 0.85rem;
      letter-spacing: 0.5px;
      color: #5f748e;
    }

    .value-badge {
      background: #e2eaf3;
      padding: 0.2rem 1rem;
      border-radius: 30px;
      font-size: 0.9rem;
    }

    input, textarea, select {
      width: 100%;
      padding: 0.9rem 1.5rem;
      border: 1px solid #cfddee;
      border-radius: 60px;
      font-size: 1rem;
      background: white;
      transition: 0.2s;
      font-family: inherit;
    }

    textarea {
      border-radius: 1.8rem;
      resize: vertical;
    }

    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 4px #3b82f620;
    }

    .color-duo {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .color-picker {
      flex: 1 1 130px;
    }

    .color-picker label {
      font-size: 0.85rem;
      color: #5f748e;
      display: block;
      margin-bottom: 0.25rem;
    }

    .color-picker input[type="color"] {
      width: 100%;
      height: 50px;
      border-radius: 50px;
      padding: 0.2rem;
      background: white;
      cursor: pointer;
    }

    input[type=range] {
      padding: 0;
      height: 8px;
      background: #dae3ed;
      border-radius: 20px;
      -webkit-appearance: none;
    }

    input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 22px;
      height: 22px;
      background: #0b1f33;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 4px 8px #0b1f3370;
      cursor: pointer;
      margin-top: -7px;
    }

    .reset-btn {
      background: transparent;
      border: 1.5px solid #b9cbdf;
      color: #1e3f62;
      padding: 0.75rem;
      border-radius: 60px;
      font-weight: 600;
      width: 100%;
      cursor: pointer;
      transition: 0.15s;
      margin-top: 1rem;
    }

    .reset-btn:hover {
      background: #e1ebf7;
      border-color: #809ab3;
    }

    /* loading overlay */
    #loadingIndicator {
      display: none;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-left: 15px;
      color: #1e3f62;
      font-weight: 500;
    }

    #loadingIndicator .spinner {
      width: 20px;
      height: 20px;
      border: 3px solid #ccc;
      border-top-color: #0b1f33;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin { to { transform: rotate(360deg); } }

    @media (max-width: 650px) {
      body { padding: 0.8rem; }
      .tool-container { padding: 1.5rem; }
    }
  </style>
</head>
<body>
<div class="tool-container">
  <h1>üìÑ PDF generator ¬∑ direct download</h1>
  <div class="subhead">tweak styles & content ‚Üí click ‚Äúdownload PDF‚Äù ‚Üí image‚Äëbased, high‚Äëquality</div>

  <div class="dashboard">
    <!-- controls -->
    <div class="control-panel">
      <div class="control-group">
        <div class="label-row"><span>üìå title</span></div>
        <input type="text" id="titleInput" value="Responsive PDF" placeholder="e.g. Q3 Report">
      </div>

      <div class="control-group">
        <div class="label-row"><span>üîñ subtitle</span></div>
        <input type="text" id="subtitleInput" value="designed with care" placeholder="subtitle">
      </div>

      <div class="control-group">
        <div class="label-row"><span>‚úçÔ∏è body text</span></div>
        <textarea id="bodyInput" rows="3">This PDF was generated directly from the DOM. No print dialog needed ‚Äì just click and save.</textarea>
      </div>

      <div class="color-duo">
        <div class="color-picker">
          <label>üé® background</label>
          <input type="color" id="bgColorInput" value="#f6f2ff">
        </div>
        <div class="color-picker">
          <label>‚úíÔ∏è text color</label>
          <input type="color" id="textColorInput" value="#121826">
        </div>
      </div>

      <div class="control-group" style="margin-top: 1.8rem;">
        <div class="label-row"><span>üî§ font family</span></div>
        <select id="fontSelect">
          <option value="Inter, sans-serif" selected>Sans (Inter)</option>
          <option value="Merriweather, serif">Serif (Merriweather)</option>
          <option value="'Source Code Pro', monospace">Monospace</option>
          <option value="system-ui, sans-serif">System UI</option>
        </select>
      </div>

      <div class="control-group">
        <div class="label-row">
          <span>‚¨ú inner padding</span>
          <span class="value-badge" id="paddingValue">32px</span>
        </div>
        <input type="range" id="paddingSlider" min="12" max="80" value="32" step="1">
      </div>

      <button class="reset-btn" id="resetBtn">‚Üª reset to default</button>
    </div>

    <!-- preview + download -->
    <div class="preview-area">
      <div class="preview-header">
        <h2>üëÄ live preview</h2>
        <button class="generate-btn" id="downloadPdfBtn">
          ‚¨á download PDF
          <span id="loadingIndicator"><span class="spinner"></span> rendering...</span>
        </button>
      </div>

      <div class="card-preview" id="previewCard" style="background-color: #f6f2ff; color: #121826; padding: 32px; font-family: 'Inter', sans-serif;">
        <h2 id="previewTitle">Responsive PDF</h2>
        <h3 id="previewSubtitle">designed with care</h3>
        <p id="previewBody">This PDF was generated directly from the DOM. No print dialog needed ‚Äì just click and save.</p>
      </div>
      <p style="color: #526e8c; margin-top: 0.8rem; font-size: 0.9rem;">‚¨ÜÔ∏è PDF will look exactly like this card. Uses canvas + jsPDF.</p>
    </div>
  </div>
</div>

<script>
  (function() {
    // --- DOM references
    const previewCard = document.getElementById('previewCard');
    const titleEl = document.getElementById('previewTitle');
    const subtitleEl = document.getElementById('previewSubtitle');
    const bodyEl = document.getElementById('previewBody');

    const titleInput = document.getElementById('titleInput');
    const subtitleInput = document.getElementById('subtitleInput');
    const bodyInput = document.getElementById('bodyInput');
    const bgColorInput = document.getElementById('bgColorInput');
    const textColorInput = document.getElementById('textColorInput');
    const fontSelect = document.getElementById('fontSelect');
    const paddingSlider = document.getElementById('paddingSlider');
    const paddingValue = document.getElementById('paddingValue');
    const resetBtn = document.getElementById('resetBtn');
    const downloadBtn = document.getElementById('downloadPdfBtn');
    const loadingIndicator = document.getElementById('loadingIndicator');

    // Default values
    const defaults = {
      title: 'Responsive PDF',
      subtitle: 'designed with care',
      body: 'This PDF was generated directly from the DOM. No print dialog needed ‚Äì just click and save.',
      bgColor: '#f6f2ff',
      textColor: '#121826',
      font: 'Inter, sans-serif',
      padding: 32
    };

    // --- update preview from inputs
    function updatePreview() {
      titleEl.textContent = titleInput.value || '‚Äã';   // zero‚Äëwidth space to preserve height
      subtitleEl.textContent = subtitleInput.value || '‚Äã';
      bodyEl.textContent = bodyInput.value || '‚Äã';

      previewCard.style.backgroundColor = bgColorInput.value;
      previewCard.style.color = textColorInput.value;
      previewCard.style.fontFamily = fontSelect.value;

      const pad = paddingSlider.value + 'px';
      previewCard.style.padding = pad;
      paddingValue.textContent = paddingSlider.value + 'px';
    }

    // --- reset to defaults
    resetBtn.addEventListener('click', function() {
      titleInput.value = defaults.title;
      subtitleInput.value = defaults.subtitle;
      bodyInput.value = defaults.body;
      bgColorInput.value = defaults.bgColor;
      textColorInput.value = defaults.textColor;
      fontSelect.value = defaults.font;
      paddingSlider.value = defaults.padding;
      updatePreview();
    });

    // --- live update on input
    [titleInput, subtitleInput, bodyInput, bgColorInput, textColorInput, fontSelect, paddingSlider].forEach(el => {
      el.addEventListener('input', updatePreview);
    });
    fontSelect.addEventListener('change', updatePreview); // for safer select

    // --- PDF download (using html2canvas + jsPDF)
    downloadBtn.addEventListener('click', async function(e) {
      // show loading indicator inside button
      loadingIndicator.style.display = 'inline-flex';
      downloadBtn.disabled = true; // prevent double click

      try {
        // get the card element
        const card = document.getElementById('previewCard');

        // Use html2canvas to capture the card with higher scale for quality
        const canvas = await html2canvas(card, {
          scale: 2.5,              // high resolution
          backgroundColor: null,    // respect background color from card
          allowTaint: false,
          useCORS: true,
          logging: false,
          windowWidth: card.scrollWidth,
          windowHeight: card.scrollHeight
        });

        // get canvas data as JPEG (good compression, small size)
        const imgData = canvas.toDataURL('image/jpeg', 0.95);

        // Create jsPDF instance: we want a PDF with dimensions matching the card's aspect ratio
        const { jsPDF } = window.jspdf;

        // orientation: portrait or landscape based on card dimensions
        const cardWidth = card.offsetWidth;
        const cardHeight = card.offsetHeight;
        const isLandscape = cardWidth > cardHeight;

        // PDF unit: mm. Choose size that keeps content crisp.
        // We'll set PDF width to 190mm (with small margins) and adjust height proportionally.
        let pdfWidth, pdfHeight;
        if (isLandscape) {
          pdfWidth = 280; // mm, for landscape (like A4 landscape ~297mm but we keep some margin)
          pdfHeight = (cardHeight / cardWidth) * pdfWidth;
        } else {
          pdfWidth = 200; // mm, roughly A4 width minus margins
          pdfHeight = (cardHeight / cardWidth) * pdfWidth;
        }

        // Create PDF with custom dimensions
        const pdf = new jsPDF({
          orientation: pdfWidth > pdfHeight ? 'landscape' : 'portrait',
          unit: 'mm',
          format: [pdfWidth, pdfHeight]
        });

        // add image to fill the whole page
        pdf.addImage(imgData, 'JPEG', 0, 0, pdfWidth, pdfHeight, undefined, 'FAST');

        // Save PDF
        pdf.save('custom-document.pdf');
      } catch (error) {
        console.error('PDF generation error:', error);
        alert('Sorry, PDF could not be generated. Check console for details.');
      } finally {
        loadingIndicator.style.display = 'none';
        downloadBtn.disabled = false;
      }
    });

    // initial update
    updatePreview();

    // Also update preview on window resize (optional) ‚Äî keeps padding consistent, but not necessary
    window.addEventListener('resize', function() {
      // No need to change anything, but we might re-calc? not needed.
    });
  })();
</script>
<!-- ensure print color adjustment is not needed anymore, but keep for safety -->
<style>
  #previewCard {
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }
</style>
</body>
</html>
